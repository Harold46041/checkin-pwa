<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Magnolia Wealth — Check-In</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="theme-color" content="#2ea44f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icons/apple-touch-icon-180.png">
  <link rel="icon" sizes="192x192" href="icons/icon-192.png">
  <link rel="icon" sizes="512x512" href="icons/icon-512.png">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <div class="logo-fallback">MW</div>
      <div class="titles">
        <h1>Client Check-In</h1>
        <p class="subtitle">Offline-first • iPad friendly</p>
      </div>
    </div>
    <div class="stats">
      <div class="stat"><span id="totalCount">0</span><label>Total</label></div>
      <div class="stat"><span id="checkedCount">0</span><label>Checked-In</label></div>
      <div class="stat"><span id="remainingCount">0</span><label>Remaining</label></div>
    </div>
  </header>

  <section class="toolbar">
    <div class="row">
      <select id="eventSelect" class="event-select" aria-label="Event selector"></select>
      <button id="newEventBtn" class="btn">+ New Event</button>
      <input id="searchInput" class="search" type="search" placeholder="Search name, email, phone…" autocomplete="off" />
      <button id="clearSearchBtn" class="btn ghost">Clear</button>
    </div>
    <div class="row">
      <label class="file-btn">
        <input id="importCsvInput" type="file" accept=".csv" hidden>
        Import CSV
      </label>
      <button id="exportCsvBtn" class="btn">Export CSV</button>
      <button id="exportZipBtn" class="btn">Export ZIP (CSV + PNGs)</button>
      <button id="scanQrBtn" class="btn">Scan QR</button>
      <button id="showNotCheckedBtn" class="btn ghost">Filter: Not Checked-In</button>
    </div>
  </section>

  <main id="list" class="list"></main>

  <!-- Signature Modal -->
  <dialog id="sigDialog">
    <div class="sig-header">
      <h3>Signature</h3>
      <button id="sigClose" class="btn ghost">Close</button>
    </div>
    <canvas id="sigCanvas" width="800" height="300"></canvas>
    <div class="sig-actions">
      <button id="sigClear" class="btn ghost">Clear</button>
      <button id="sigSave" class="btn">Save Signature</button>
    </div>
  </dialog>

  <!-- Edit Modal -->
  <dialog id="editDialog">
    <div class="sig-header">
      <h3>Edit Guest</h3>
      <button id="editClose" class="btn ghost">Close</button>
    </div>
    <div class="edit-form">
      <label>Name <input id="editName" type="text" placeholder="Full name"></label>
      <label>Email <input id="editEmail" type="email" placeholder="email@example.com"></label>
      <label>Phone <input id="editPhone" type="tel" placeholder="555-555-5555"></label>
    </div>
    <div class="sig-actions">
      <button id="editDelete" class="btn ghost">Delete</button>
      <button id="editSave" class="btn">Save</button>
    </div>
  </dialog>

  <!-- QR Modal -->
  <dialog id="qrDialog">
    <div class="qr-header">
      <h3>Scan QR</h3>
      <button id="qrClose" class="btn ghost">Close</button>
    </div>
    <video id="qrVideo" playsinline autoplay muted></video>
    <div class="qr-status" id="qrStatus">Point camera at code…</div>
  </dialog>

  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./service-worker.js').catch(console.error);
      });
    }
  </script>
  <script src="app.js"></script>
</body>
</html>
